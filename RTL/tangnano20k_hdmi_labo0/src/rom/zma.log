Z80 Macro Assembler ZMA v1.0.18
=====================================================
Programmed by t.hara

  DEFS is DEFINE STRING (default).
  OUTPUT TYPE: BINARY

<< code >>
LINE# |OFFSET|ADDR|MNEMONIC
======+======+====+==================================
     7|      |    |REG_PATTERN_MODE := 0x10
      |      |    |  Global integer symbol [REG_PATTERN_MODE] = 16 (0x10)
------+------+----+----------------------------------
     8|      |    |REG_KEY_STATE := 0x10
      |      |    |  Global integer symbol [REG_KEY_STATE] = 16 (0x10)
------+------+----+----------------------------------
     9|      |    |MODE_VALUE := 0xF400
      |      |    |  Global integer symbol [MODE_VALUE] = 62464 (0xf400)
------+------+----+----------------------------------
    11|      |    |ORG 0x0000
------+------+----+----------------------------------
    13|      |    |DI
      |      |    |  Z80:5cyc R800:2cyc
      |000000|0000|  F3
------+------+----+----------------------------------
    14|      |    |LD SP, 0
      |      |    |  Z80:11cyc R800:3cyc
      |000001|0001|  31 00 00
------+------+----+----------------------------------
    15|      |    |XOR A, A
      |      |    |  Z80:5cyc R800:1cyc
      |000004|0004|  AF
------+------+----+----------------------------------
    16|      |    |LD [ MODE_VALUE ], A
      |      |    |  Z80:14cyc R800:6cyc
      |000005|0005|  32 00 F4
------+------+----+----------------------------------
    17|      |    |OUT [ REG_PATTERN_MODE ], A
      |      |    |  Z80:12cyc R800:10cyc/9cyc
      |000008|0008|  D3 10
------+------+----+----------------------------------
    19|      |    |WAIT_KEY_RELEASE :
      |      |    |  label [WAIT_KEY_RELEASE] address: 0x00000a
------+------+----+----------------------------------
    20|      |    |CALL GETKEY
      |      |    |  Z80:18cyc R800:5cyc
      |00000A|000A|  CD 32 00
------+------+----+----------------------------------
    21|      |    |OR A, A
      |      |    |  Z80:5cyc R800:1cyc
      |00000D|000D|  B7
------+------+----+----------------------------------
    22|      |    |JR NZ, WAIT_KEY_RELEASE
      |      |    |  Z80:13cyc/8cyc R800:3cyc/2cyc
      |00000E|000E|  20 FA
------+------+----+----------------------------------
    24|      |    |MAIN_LOOP :
      |      |    |  label [MAIN_LOOP] address: 0x000010
------+------+----+----------------------------------
    25|      |    |CALL GETKEY
      |      |    |  Z80:18cyc R800:5cyc
      |000010|0010|  CD 32 00
------+------+----+----------------------------------
    26|      |    |OR A, A
      |      |    |  Z80:5cyc R800:1cyc
      |000013|0013|  B7
------+------+----+----------------------------------
    27|      |    |JR Z, MAIN_LOOP
      |      |    |  Z80:13cyc/8cyc R800:3cyc/2cyc
      |000014|0014|  28 FA
------+------+----+----------------------------------
    29|      |    |RRCA
      |      |    |  Z80:5cyc R800:1cyc
      |000016|0016|  0F
------+------+----+----------------------------------
    30|      |    |JR C, PRESS_BUTTON0
      |      |    |  Z80:13cyc/8cyc R800:3cyc/2cyc
      |000017|0017|  38 03
------+------+----+----------------------------------
    31|      |    |RRCA
      |      |    |  Z80:5cyc R800:1cyc
      |000019|0019|  0F
------+------+----+----------------------------------
    32|      |    |JR C, PRESS_BUTTON1
      |      |    |  Z80:13cyc/8cyc R800:3cyc/2cyc
      |00001A|001A|  38 0B
------+------+----+----------------------------------
    34|      |    |PRESS_BUTTON0 :
      |      |    |  label [PRESS_BUTTON0] address: 0x00001c
------+------+----+----------------------------------
    35|      |    |LD A, [ MODE_VALUE ]
      |      |    |  Z80:14cyc R800:6cyc
      |00001C|001C|  3A 00 F4
------+------+----+----------------------------------
    36|      |    |INC A
      |      |    |  Z80:5cyc R800:1cyc
      |00001F|001F|  3C
------+------+----+----------------------------------
    37|      |    |LD [ MODE_VALUE ], A
      |      |    |  Z80:14cyc R800:6cyc
      |000020|0020|  32 00 F4
------+------+----+----------------------------------
    38|      |    |OUT [ REG_PATTERN_MODE ], A
      |      |    |  Z80:12cyc R800:10cyc/9cyc
      |000023|0023|  D3 10
------+------+----+----------------------------------
    39|      |    |JR WAIT_KEY_RELEASE
      |      |    |  Z80:13cyc R800:3cyc
      |000025|0025|  18 E3
------+------+----+----------------------------------
    41|      |    |PRESS_BUTTON1 :
      |      |    |  label [PRESS_BUTTON1] address: 0x000027
------+------+----+----------------------------------
    42|      |    |LD A, [ MODE_VALUE ]
      |      |    |  Z80:14cyc R800:6cyc
      |000027|0027|  3A 00 F4
------+------+----+----------------------------------
    43|      |    |DEC A
      |      |    |  Z80:5cyc R800:1cyc
      |00002A|002A|  3D
------+------+----+----------------------------------
    44|      |    |LD [ MODE_VALUE ], A
      |      |    |  Z80:14cyc R800:6cyc
      |00002B|002B|  32 00 F4
------+------+----+----------------------------------
    45|      |    |OUT [ REG_PATTERN_MODE ], A
      |      |    |  Z80:12cyc R800:10cyc/9cyc
      |00002E|002E|  D3 10
------+------+----+----------------------------------
    46|      |    |JR WAIT_KEY_RELEASE
      |      |    |  Z80:13cyc R800:3cyc
      |000030|0030|  18 D8
------+------+----+----------------------------------
    59|      |    |SCOPE GETKEY
      |      |    |  Enter scope: GETKEY:
------+------+----+----------------------------------
    60|      |    |GETKEY ::
      |      |    |  global label [GETKEY] address: 0x000032
------+------+----+----------------------------------
    61|      |    |IN A, [ REG_KEY_STATE ]
      |      |    |  Z80:12cyc R800:10cyc/9cyc
      |000032|0032|  DB 10
------+------+----+----------------------------------
    62|      |    |RLCA
      |      |    |  Z80:5cyc R800:1cyc
      |000034|0034|  07
------+------+----+----------------------------------
    63|      |    |RLCA
      |      |    |  Z80:5cyc R800:1cyc
      |000035|0035|  07
------+------+----+----------------------------------
    64|      |    |RET
      |      |    |  Z80:11cyc R800:5cyc
      |000036|0036|  C9
------+------+----+----------------------------------
    65|      |    |ENDSCOPE
      |      |    |  Exit scope: GETKEY:
------+------+----+----------------------------------
<< label >>
GETKEY ............. 50 ( 0x32 )
MAIN_LOOP .......... 16 ( 0x10 )
MODE_VALUE ......... 62464 ( 0xf400 )
PRESS_BUTTON0 ...... 28 ( 0x1c )
PRESS_BUTTON1 ...... 39 ( 0x27 )
REG_KEY_STATE ...... 16 ( 0x10 )
REG_PATTERN_MODE ... 16 ( 0x10 )
WAIT_KEY_RELEASE ... 10 ( 0xa )
